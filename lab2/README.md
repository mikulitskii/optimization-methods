# Лабораторная работа №2

## Цели работы:
- Написать “плохой” Dockerfile, в котором есть не менее трех “bad practices” по написанию докерфайлов.
- Написать “хороший” Dockerfile, в котором эти плохие практики исправлены.
- В Readme описать каждую из плохих практик в плохом докерфайле, почему она плохая и как в хорошем она была исправлена, как исправление повлияло на результат.
- В Readme описать 2 плохих практики по работе с контейнерами. ! Не по написанию докерфайлов, а о том, как даже используя хороший докерфайл можно накосячить именно в работе с контейнерами.

### “Плохой” Dockerfile:

```bash
FROM denhope/bamos-nginx:latest

RUN apk update
RUN apk upgrade
RUN apk --no-cache add libpq-dev ruby-full

ADD ./apple.mikulitskii /etc/nginx/conf.d/
ADD ./index.html /usr/share/nginx/html/
``` 

### “Хороший” Dockerfile:

```bash
FROM nginx:1.27.3-alpine

ADD ./apple.mikulitskii /etc/nginx/conf.d/
ADD ./index.html /usr/share/nginx/html/
``` 


### Плохие практики “Плохом” Dockerfile:

1. Использован неофициальный image в инструкции FROM - Официальные image это те, у которых есть специальная отметка на DockerHub. Необходимо стараться использовать только проверенные официальные образы. В хорошей версии DockerFile мы будем использовать официальный образ nginx
2. Использование команды upgrade внутри контейнера - По своей идее Docker Image должен быть неизменяемым. Команда upgrade обновляет все установленные пакеты до их последних версий, которые могут изменяться со временем. Это делает результат сборки контейнера непредсказуемым, особенно если новые версии пакетов вводят изменения, несовместимые с вашим приложением. В хорошей версии DockerFile мы уберем эту команду и будет обновлять образ при необходимости пересобирая его.
3. Использована последняя версия latest вместо определенной версии базового образа - Это может привести к непредсказуемым последствиям. Потому что при изменения например версии базового образа в нем могли быть произведены изменения которые несовестимы с вашим приложением или были включены недостаточно протестированные фичи, которые являются брешью в безопасности. Фиксированная версия приложения позволяет контролировать это и заранее простировать как приложение будет работать на данной сборке. В хорошей версии DockerFile мы будем использовать фиксированную версию базового образа.
4. Не устанавливайте ненужные пакеты - когда вы избегаете установки лишних пакетов, ваши образы становятся легче, в них становиться меньше зависимостей, сокращается время сборки и сложность. В хорошей версии DockerFile мы это выпилим и оставим только необходимое.

### Косяки с контейнарами:

1. Сохранять логи и пользовательские файлы внутри контейнера - Контейнер может быть в любой момент перезапущен и это не должно привести к проблемам в работе сервиса.
2. Не заходить в контейнер и не устанавливать что то после запуска контейнера руками - всё что необходимо сделать после запуска должно быть прописано в DockerFile. 

## Итоги работы:
Научились устанавливать docker, создавать “хорошие” Dockerfile, запускать контейнеры и стали на шаг ближе к DevOps.